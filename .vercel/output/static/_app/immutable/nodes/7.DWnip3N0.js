import{f as w,a as f,t as ie}from"../chunks/DUlsYC3j.js";import{i as Je}from"../chunks/D1Mnw4Fy.js";import{o as Ve}from"../chunks/gMiQyaKI.js";import{p as Xe,l as Ke,c as Qe,g as e,d as Ze,e as et,i as o,j as l,t as P,o as tt,s as n,m,$ as rt,n as F,r as s,k as at,u as y,f as st}from"../chunks/DfM-zcOs.js";import{e as $,s as A}from"../chunks/Ce7UJ3xo.js";import{i as ne}from"../chunks/BxkL2RRF.js";import{h as ot,e as D,r as U,i as q,s as R}from"../chunks/pTKB1-Ql.js";import{a as z,c as $e,b as lt}from"../chunks/Dlfh-MLN.js";import{s as it,a as nt}from"../chunks/dSDtfX3-.js";import{g as dt}from"../chunks/5wH2ZyBx.js";import{p as G}from"../chunks/DsqSX7aj.js";import{a as ct}from"../chunks/yMEJVJxs.js";import{B as de}from"../chunks/BSl4I6XK.js";import{t as h}from"../chunks/zpaCH91C.js";import{R as ut}from"../chunks/DshLg9oX.js";import{X as Ie}from"../chunks/B6aFb63J.js";var pt=w('<div class="relative rounded-lg overflow-hidden border-2 border-input"><img class="w-full h-32 object-cover"/> <button type="button" class="absolute top-1 right-1 bg-destructive text-destructive-foreground p-1.5 rounded-full hover:bg-destructive/90 transition-colors"><!></button> <div class="absolute bottom-1 left-1 bg-black/70 text-white text-xs px-2 py-0.5 rounded"></div></div>'),mt=w('<div class="relative rounded-lg overflow-hidden border-2 border-input"><img class="w-full h-32 object-cover"/> <button type="button" class="absolute top-1 right-1 bg-destructive text-destructive-foreground p-1.5 rounded-full hover:bg-destructive/90 transition-colors"><!></button> <div class="absolute bottom-1 left-1 bg-black/70 text-white text-xs px-2 py-0.5 rounded"></div></div>'),vt=w('<div class="grid grid-cols-2 sm:grid-cols-3 gap-4 mb-4"><!> <!></div>'),gt=w('<div class="border-2 border-dashed border-input rounded-lg p-6 text-center hover:border-primary transition-colors"><input id="coverImages" type="file" accept="image/*" multiple class="hidden"/> <label for="coverImages" class="cursor-pointer"><div class="flex flex-col items-center gap-2"><svg class="w-10 h-10 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg> <span class="text-sm text-foreground font-medium">Click to upload images</span> <span class="text-xs text-muted-foreground"> </span></div></label></div> <div class="flex gap-2"><input type="url" class="flex-1 px-4 py-2 border-2 border-input rounded-lg bg-background text-foreground placeholder:text-muted-foreground focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all outline-none text-sm" placeholder="Or paste image URL..."/> <button type="button" class="px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm font-medium">Add URL</button></div>',1),ft=w('<p class="text-sm text-muted-foreground text-center py-4 bg-muted/50 rounded-lg">Maximum 6 images reached</p>'),bt=w('<label class="flex items-center space-x-2 cursor-pointer p-2 hover:bg-gray-50 rounded-lg transition-colors"><input type="checkbox" class="w-4 h-4 rounded border-gray-300 text-primary focus:ring-2 focus:ring-primary/20"/> <span class="text-sm font-medium text-black"> </span></label>'),xt=w('<span class="inline-flex items-center gap-1 px-2.5 sm:px-3 py-1 sm:py-1.5 bg-primary/10 text-primary rounded-full text-xs sm:text-sm font-semibold"> <button type="button" class="hover:text-red-600 text-base sm:text-lg font-bold">Ã—</button></span>'),ht=w('<div class="flex flex-wrap gap-2 mt-3"></div>'),_t=w('<div class="min-h-screen bg-white"><div class="container mx-auto px-4 sm:px-6 py-6 sm:py-8 max-w-4xl"><div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6 sm:mb-8"><h1 class="text-2xl sm:text-3xl font-bold text-black">Write New Teaching</h1> <a href="/admin"><!></a></div> <form class="space-y-5 sm:space-y-6"><div class="bg-white p-4 sm:p-5 md:p-6 rounded-xl border-2 border-gray-200 space-y-5 sm:space-y-6 shadow-lg"><div class="space-y-2"><label for="title" class="text-xs sm:text-sm font-bold text-black uppercase tracking-wide">Title</label> <input id="title" type="text" required class="w-full px-3 sm:px-4 py-2.5 sm:py-3 border-2 border-gray-200 rounded-xl bg-white text-black placeholder:text-gray-400 focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all outline-none text-sm sm:text-base" placeholder="Enter your teaching title..."/></div> <div class="space-y-2"><label for="content" class="text-xs sm:text-sm font-bold text-black uppercase tracking-wide">Content</label> <!></div> <div class="space-y-2"><label for="excerpt" class="text-xs sm:text-sm font-bold text-black uppercase tracking-wide">Excerpt (Optional)</label> <textarea id="excerpt" rows="3" class="w-full px-3 sm:px-4 py-2.5 sm:py-3 border-2 border-gray-200 rounded-xl bg-white text-black placeholder:text-gray-400 focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all outline-none resize-y text-sm sm:text-base" placeholder="Brief summary for preview..."></textarea></div> <div class="space-y-2"><div class="text-sm font-medium text-foreground" role="heading" aria-level="3">Cover Images (Optional - Max 6 for carousel)</div> <!> <!></div> <div class="space-y-2"><div class="text-xs sm:text-sm font-bold text-black uppercase tracking-wide">Categories</div> <div class="grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3"></div></div> <div class="space-y-2"><label for="tagInput" class="text-xs sm:text-sm font-bold text-black uppercase tracking-wide">Tags</label> <div class="flex flex-col sm:flex-row gap-2"><input id="tagInput" type="text" class="flex-1 px-3 sm:px-4 py-2.5 sm:py-3 border-2 border-gray-200 rounded-xl bg-white text-black placeholder:text-gray-400 focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all outline-none text-sm sm:text-base" placeholder="Add tags..."/> <!></div> <!></div> <div class="space-y-3 pt-4 border-t-2 border-gray-200"><label class="flex items-center space-x-2 sm:space-x-3 cursor-pointer p-2 hover:bg-gray-50 rounded-lg transition-colors"><input type="checkbox" class="w-4 h-4 sm:w-5 sm:h-5 rounded border-gray-300 text-primary focus:ring-2 focus:ring-primary/20"/> <span class="text-sm sm:text-base font-bold text-black">Publish immediately</span></label> <label class="flex items-center space-x-2 sm:space-x-3 cursor-pointer p-2 hover:bg-gray-50 rounded-lg transition-colors"><input type="checkbox" class="w-4 h-4 sm:w-5 sm:h-5 rounded border-gray-300 text-primary focus:ring-2 focus:ring-primary/20"/> <span class="text-sm sm:text-base font-bold text-black">Feature this post</span></label></div></div> <div class="flex flex-col sm:flex-row justify-end gap-3"><!></div></form></div></div>');function St(Ce,Pe){Xe(Pe,!1);const ce=()=>nt(ct,"$authStore",Ue),[Ue,Re]=it(),N=m(),Te=[];let E=m(""),T=m(""),O=m(""),W="",u=m([]),L=m(""),Y=m(!1),H=m(!1),j=m(!1),B=m(!1),k=[],g=m([]),ue=m([]),J=m([]),I=m(""),_=m([]),Me=[];Ve(async()=>{try{n(ue,await G.getCategories()),Me=await G.getTags()}catch(t){console.error("Error loading data:",t)}});function pe(){e(I).trim()&&!e(_).includes(e(I).trim())&&(n(_,[...e(_),e(I).trim()]),n(I,""))}function Fe(t){n(_,e(_).filter(r=>r!==t))}async function Ee(t){const a=t.target.files;if(!(!a||a.length===0)){if(k.length+a.length>6){h.error("You can upload maximum 6 images");return}for(const i of Array.from(a)){if(!i.type.startsWith("image/")){h.error(`${i.name} is not an image file`);continue}if(i.size>5*1024*1024){h.error(`${i.name} is larger than 5MB`);continue}k=[...k,i];const c=new FileReader;c.onload=v=>{var d;n(g,[...e(g),(d=v.target)==null?void 0:d.result])},c.readAsDataURL(i)}}}function Le(t){k=k.filter((r,a)=>a!==t),n(g,e(g).filter((r,a)=>a!==t))}function je(t){n(u,e(u).filter((r,a)=>a!==t))}function Be(){if(W.trim()){if(e(u).length>=6){h.error("Maximum 6 images allowed");return}n(u,[...e(u),W.trim()]),W=""}}async function Se(t){if(t.preventDefault(),!e(N)){h.error("You must be logged in to create a post");return}if(!e(E).trim()||!e(T).trim()){h.error("Title and content are required");return}n(j,!0);try{let r=[...e(u)];if(k.length>0){n(B,!0);try{for(const a of k){const i=`${Date.now()}-${Math.random().toString(36).substring(7)}-${a.name}`,c=await G.uploadImage(a,i);r.push(c)}h.success(`${k.length} image(s) uploaded successfully`)}catch(a){console.error("Error uploading images:",a),h.error("Failed to upload some images")}finally{n(B,!1)}}await G.createPost(e(N).id,{title:e(E),content:e(T),excerpt:e(O)||e(T).substring(0,200),published:e(Y),featured:e(H),cover_image:r[0]||"",cover_images:r.length>0?r:void 0,category_ids:e(J),tag_names:e(_),scheduled_at:null,series_id:null,series_order:null}),h.success("Post created successfully!"),dt("/admin")}catch(r){console.error("Error creating post:",r),h.error(r.message||"Failed to create post")}finally{n(j,!1)}}Ke(()=>ce(),()=>{n(N,ce().user)}),Qe(),Je();var V=_t();ot("704o08",t=>{et(()=>{rt.title="Write Post - ChristFocus"})});var me=o(V),X=o(me),ve=l(o(X),2),Ae=o(ve);de(Ae,{variant:"outline",class:"w-full sm:w-auto",children:(t,r)=>{F();var a=ie("Cancel");f(t,a)},$$slots:{default:!0}}),s(ve),s(X);var K=l(X,2),Q=o(K),Z=o(Q),ge=l(o(Z),2);U(ge),s(Z);var ee=l(Z,2),De=l(o(ee),2);ut(De,{get content(){return e(T)},set content(t){n(T,t)},$$legacy:!0}),s(ee);var te=l(ee,2),fe=l(o(te),2);at(fe),s(te);var re=l(te,2),be=l(o(re),2);{var qe=t=>{var r=vt(),a=o(r);D(a,1,()=>e(g),q,(c,v,d)=>{var b=pt(),x=o(b);R(x,"alt",`Preview ${d+1}`);var p=l(x,2);R(p,"aria-label",`Remove image ${d+1}`);var C=o(p);Ie(C,{class:"w-4 h-4"}),s(p);var M=l(p,2);M.textContent=`File ${d+1}`,s(b),P(()=>R(x,"src",e(v))),$("click",p,()=>Le(d)),f(c,b)});var i=l(a,2);D(i,1,()=>e(u),q,(c,v,d)=>{var b=mt(),x=o(b);R(x,"alt",`Cover ${d+1}`);var p=l(x,2);R(p,"aria-label",`Remove URL ${d+1}`);var C=o(p);Ie(C,{class:"w-4 h-4"}),s(p);var M=l(p,2);M.textContent=`URL ${d+1}`,s(b),P(()=>R(x,"src",e(v))),$("click",p,()=>je(d)),f(c,b)}),s(r),f(t,r)};ne(be,t=>{e(g),e(u),y(()=>e(g).length>0||e(u).length>0)&&t(qe)})}var ze=l(be,2);{var Ge=t=>{var r=gt(),a=st(r),i=o(a),c=l(i,2),v=o(c),d=l(o(v),4),b=o(d);s(d),s(v),s(c),s(a);var x=l(a,2),p=o(x);U(p);var C=l(p,2);s(x),P(()=>{A(b,`PNG, JPG, GIF up to 5MB each (${e(g),e(u),y(()=>e(g).length+e(u).length)??""}/6)`),C.disabled=(e(L),e(g),e(u),y(()=>!e(L)||e(g).length+e(u).length>=6))}),$("change",i,Ee),z(p,()=>e(L),M=>n(L,M)),$("click",C,Be),f(t,r)},Ne=t=>{var r=ft();f(t,r)};ne(ze,t=>{e(g),e(u),y(()=>e(g).length+e(u).length<6)?t(Ge):t(Ne,!1)})}s(re);var ae=l(re,2),xe=l(o(ae),2);D(xe,5,()=>e(ue),q,(t,r)=>{var a=bt(),i=o(a);U(i);var c,v=l(i,2),d=o(v,!0);s(v),s(a),P(()=>{c!==(c=(e(r),y(()=>e(r).id)))&&(i.value=(i.__value=(e(r),y(()=>e(r).id)))??""),A(d,(e(r),y(()=>e(r).name)))}),lt(Te,[],i,()=>(e(r),y(()=>e(r).id),e(J)),b=>n(J,b)),f(t,a)}),s(xe),s(ae);var se=l(ae,2),oe=l(o(se),2),S=o(oe);U(S);var Oe=l(S,2);de(Oe,{type:"button",class:"w-full sm:w-auto",$$events:{click:pe},children:(t,r)=>{F();var a=ie("Add");f(t,a)},$$slots:{default:!0}}),s(oe);var We=l(oe,2);{var Ye=t=>{var r=ht();D(r,5,()=>e(_),q,(a,i)=>{var c=xt(),v=o(c),d=l(v);s(c),P(()=>A(v,`${e(i)??""} `)),$("click",d,()=>Fe(e(i))),f(a,c)}),s(r),f(t,r)};ne(We,t=>{e(_),y(()=>e(_).length>0)&&t(Ye)})}s(se);var he=l(se,2),le=o(he),_e=o(le);U(_e),F(2),s(le);var ye=l(le,2),we=o(ye);U(we),F(2),s(ye),s(he),s(Q);var ke=l(Q,2),He=o(ke);{let t=tt(()=>e(j)||e(B));de(He,{type:"submit",get disabled(){return e(t)},class:"w-full sm:w-auto sm:min-w-[150px] bg-gradient-to-r from-primary to-gold-dark hover:from-gold-dark hover:to-primary text-black font-bold",children:(r,a)=>{F();var i=ie();P(()=>A(i,e(B)?"Uploading Image...":e(j)?"Creating...":"Create Teaching")),f(r,i)},$$slots:{default:!0}})}s(ke),s(K),s(me),s(V),z(ge,()=>e(E),t=>n(E,t)),z(fe,()=>e(O),t=>n(O,t)),z(S,()=>e(I),t=>n(I,t)),$("keydown",S,t=>t.key==="Enter"&&(t.preventDefault(),pe())),$e(_e,()=>e(Y),t=>n(Y,t)),$e(we,()=>e(H),t=>n(H,t)),$("submit",K,Se),f(Ce,V),Ze(),Re()}export{St as component};
