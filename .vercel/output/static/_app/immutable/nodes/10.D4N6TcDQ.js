import{c as rt,a as c,f as u}from"../chunks/DUlsYC3j.js";import{i as Lt}from"../chunks/D1Mnw4Fy.js";import{o as Qt,a as er}from"../chunks/gMiQyaKI.js";import{f as Be,p as qt,l as Q,s as m,m as C,g as e,ap as Re,c as Rt,i as r,u as n,r as t,j as l,t as N,d as Tt,o as wt,aZ as Mt,a_ as tr,$ as rr,n as gt}from"../chunks/DfM-zcOs.js";import{s as h,e as H}from"../chunks/Ce7UJ3xo.js";import{i as S}from"../chunks/BxkL2RRF.js";import{I as Pt,r as Qe,e as Ce,i as Te,s as Se,h as sr,a as kt}from"../chunks/pTKB1-Ql.js";import{h as ar}from"../chunks/B90x-WGo.js";import{t as $t,f as Ct}from"../chunks/BUJA3yGN.js";import{a as ft,s as Nt}from"../chunks/dSDtfX3-.js";import{p as or}from"../chunks/BMPYVcas.js";import{p as St}from"../chunks/DsqSX7aj.js";import{s as $e}from"../chunks/DzKOTJ0Y.js";import{a as xt}from"../chunks/yMEJVJxs.js";import{b as ir}from"../chunks/Bt-Xh7oU.js";import{t as et}from"../chunks/zpaCH91C.js";import{a as tt}from"../chunks/Dlfh-MLN.js";import{l as Ut,s as jt,p as Ve}from"../chunks/CMQLsNnl.js";import{s as zt}from"../chunks/CJEFSYYL.js";import{H as It}from"../chunks/CnwKjsSE.js";import{C as Et,E as Dt}from"../chunks/CH9sv8DS.js";function At(f,p){const w=Ut(p,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x=[["path",{d:"m12 19-7-7 7-7"}],["path",{d:"M19 12H5"}]];Pt(f,jt({name:"arrow-left"},()=>w,{get iconNode(){return x},children:(M,ee)=>{var A=rt(),L=Be(A);zt(L,p,"default",{},null),c(M,A)},$$slots:{default:!0}}))}function nr(f,p){const w=Ut(p,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z"}],["path",{d:"m21.854 2.147-10.94 10.939"}]];Pt(f,jt({name:"send"},()=>w,{get iconNode(){return x},children:(M,ee)=>{var A=rt(),L=Be(A);zt(L,p,"default",{},null),c(M,A)},$$slots:{default:!0}}))}const Fe={async getPostComments(f){try{const{data:p,error:w}=await $e.rpc("get_post_comments",{post_uuid:f});if(!w&&p)return console.log("Comments fetched via RPC:",p),p;console.log("RPC failed, using direct query. Error:",w);const{data:x,error:M}=await $e.from("comments").select("*").eq("post_id",f).order("created_at",{ascending:!1});return M?(console.error("Error fetching comments via direct query:",M),[]):(console.log("Comments fetched via direct query:",x),x||[])}catch(p){return console.error("Error in getPostComments:",p),[]}},async createComment(f,p){console.log("Creating comment with data:",f),console.log("parent_id value:",f.parent_id);const{data:w,error:x}=await $e.from("comments").insert({post_id:f.post_id,user_id:p||null,author_name:f.author_name,author_email:f.author_email||null,content:f.content,session_id:f.session_id||null,parent_id:f.parent_id||null}).select().single();if(x)throw console.error("Error creating comment:",x),x;return console.log("Comment created successfully:",w),w},async updateComment(f,p){const{data:w,error:x}=await $e.from("comments").update({content:p,updated_at:new Date().toISOString()}).eq("id",f).select().single();if(x)throw console.error("Error updating comment:",x),x;return w},async deleteComment(f){const{error:p}=await $e.from("comments").delete().eq("id",f);if(p)throw console.error("Error deleting comment:",p),p},async toggleCommentLike(f,p,w){const{data:x,error:M}=await $e.rpc("toggle_comment_like",{p_comment_id:f,p_user_id:p||null,p_session_id:w||null});if(M)throw console.error("Error toggling comment like:",M),M;return x},async getCommentLikesStatus(f,p,w){if(f.length===0)return{};const{data:x,error:M}=await $e.rpc("get_comment_likes_status",{p_comment_ids:f,p_user_id:p||null,p_session_id:w||null});return M?(console.error("Error fetching comment likes status:",M),{}):x||{}}};var lr=u('<div class="text-center py-8 sm:py-12 text-gray-400"><p class="text-sm">No comments yet.</p> <p class="text-xs mt-1">Be the first to share your thoughts!</p></div>'),dr=u('<button class="font-semibold hover:text-gray-700 transition-colors"> </button>'),cr=u('<button class="font-semibold text-red-500 hover:text-red-600 transition-colors">Delete</button>'),mr=u('<button class="font-semibold hover:text-gray-700 transition-colors"> </button>'),vr=u('<button class="font-semibold text-red-500 hover:text-red-600 transition-colors">Delete</button>'),ur=u('<div class="flex gap-2"><div class="flex-shrink-0 pt-0.5"><div class="w-6 h-6 sm:w-7 sm:h-7 rounded-full bg-gradient-to-br from-gray-400 to-gray-500 flex items-center justify-center text-white font-bold text-[10px] sm:text-xs"> </div></div> <div class="flex-1 min-w-0"><div class="flex items-start gap-2"><div class="flex-1 min-w-0"><div class="leading-snug mb-1"><span class="font-semibold text-[12px] sm:text-[13px] text-black mr-1.5"> </span> <span class="text-[12px] sm:text-[13px] text-gray-900 break-words whitespace-pre-wrap"> </span></div> <div class="flex items-center flex-wrap gap-x-3 gap-y-1 text-[10px] sm:text-[11px] text-gray-500 font-medium"><span> </span> <!> <button class="font-semibold hover:text-gray-700 transition-colors"> </button> <!></div></div> <button class="flex-shrink-0 p-0.5 hover:opacity-70 transition-opacity touch-manipulation svelte-1o7c3si" aria-label="Like reply"><!></button></div></div></div>'),pr=u('<button class="flex items-center gap-2 text-[11px] sm:text-xs font-semibold text-gray-500 hover:text-gray-700 transition-colors touch-manipulation svelte-1o7c3si"><span class="w-6 h-px bg-gray-300"></span> </button>'),gr=u('<div class="mt-3 space-y-3"><!> <!></div>'),fr=u('<div><label class="block text-[11px] sm:text-xs font-medium text-gray-600 mb-1">Your Name <span class="text-red-500">*</span></label> <input type="text" placeholder="Enter your name" class="w-full px-3 py-1.5 sm:py-2 text-[13px] sm:text-sm text-gray-900 bg-white border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all" required/></div>'),xr=u('<div class="mt-3 space-y-2"><!> <div class="flex gap-2"><input type="text" placeholder="Add a reply..." class="flex-1 px-3 py-1.5 sm:py-2 text-[13px] sm:text-sm text-gray-900 bg-white border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all"/> <button class="px-3 py-1.5 sm:py-2 text-[13px] sm:text-sm font-semibold text-primary hover:text-primary/80 disabled:text-gray-300 transition-colors touch-manipulation svelte-1o7c3si">Post</button> <button class="px-3 py-1.5 sm:py-2 text-[13px] sm:text-sm font-semibold text-gray-500 hover:text-gray-700 transition-colors touch-manipulation svelte-1o7c3si">Cancel</button></div></div>'),_r=u('<div class="comment-item"><div class="flex gap-2 sm:gap-3"><div class="flex-shrink-0 pt-0.5"><div class="w-8 h-8 sm:w-9 sm:h-9 rounded-full bg-gradient-to-br from-primary to-gold-dark flex items-center justify-center text-white font-bold text-sm"> </div></div> <div class="flex-1 min-w-0"><div class="flex items-start gap-2"><div class="flex-1 min-w-0"><div class="leading-snug mb-1.5"><span class="font-semibold text-[13px] sm:text-sm text-black mr-2"> </span> <span class="text-[13px] sm:text-sm text-gray-900 break-words whitespace-pre-wrap"> </span></div> <div class="flex items-center flex-wrap gap-x-3 gap-y-1 text-[11px] sm:text-xs text-gray-500 font-medium"><span> </span> <!> <button class="font-semibold hover:text-gray-700 transition-colors"> </button> <button class="font-semibold hover:text-gray-700 transition-colors">Reply</button> <!></div></div> <button class="flex-shrink-0 p-0.5 sm:p-1 hover:opacity-70 transition-opacity touch-manipulation svelte-1o7c3si" aria-label="Like comment"><!></button></div> <!> <!></div></div></div>'),hr=u('<div class="space-y-3 sm:space-y-4"></div>'),br=u('<div class="mb-2.5 sm:mb-3"><label for="comment-author-name" class="block text-[11px] sm:text-xs font-medium text-gray-600 mb-1 sm:mb-1.5">Your Name <span class="text-red-500">*</span></label> <input id="comment-author-name" type="text" placeholder="Enter your name" class="w-full px-3 py-2 text-[13px] sm:text-sm text-gray-900 bg-white border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all" required/></div>'),yr=u('<div class="instagram-comments bg-white border-t border-gray-200 svelte-1o7c3si"><div class="comments-container max-h-[600px] overflow-y-auto px-3 sm:px-4 py-3 sm:py-4 svelte-1o7c3si"><!></div> <div class="comment-input-container border-t border-gray-200 bg-white px-3 sm:px-4 py-2.5 sm:py-3"><!> <div class="flex items-center gap-2 sm:gap-3"><div class="flex-shrink-0"><div class="w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-gradient-to-br from-primary to-gold-dark flex items-center justify-center text-white font-bold text-xs sm:text-sm"> </div></div> <div class="flex-1 relative"><input type="text" placeholder="Add a comment..." class="w-full pl-3 sm:pl-4 pr-9 sm:pr-12 py-2 text-[13px] sm:text-sm border border-gray-200 rounded-full focus:outline-none focus:border-gray-400 transition-colors bg-gray-50"/> <button class="absolute right-1.5 sm:right-2 top-1/2 -translate-y-1/2 p-1 sm:p-1.5 text-primary hover:text-primary/80 disabled:text-gray-300 transition-colors touch-manipulation svelte-1o7c3si" aria-label="Post comment"><!></button></div></div></div></div>');function wr(f,p){qt(p,!1);const w=()=>ft(xt,"$authStore",x),[x,M]=Nt(),ee=C(),A=C(),L=C();let z=Ve(p,"comments",28,()=>[]),He=Ve(p,"onSubmitComment",8),G=Ve(p,"onDeleteComment",8),s=Ve(p,"canDelete",8),Me=Ve(p,"commentSessionId",8,""),X=C(""),_e=C(null),K=C(""),k=C(new Set),I=C(!1),b=C(""),de=C({});const Oe=2;async function st(){var a;try{const d=z().map(U=>U.id),E=((a=e(ee))==null?void 0:a.id)||null,o=Me()||null,W=await Fe.getCommentLikesStatus(d,E,o);m(k,new Set(Object.keys(W).filter(U=>W[U])))}catch(d){console.error("Error loading liked status:",d)}}function at(a){const d=e(L)[a]||[];return e(de)[a]?d:d.slice(0,Oe)}function Pe(a){return(e(L)[a]||[]).length-Oe}function ot(a){Mt(de,e(de)[a]=!e(de)[a]),m(de,e(de))}function Ne(a){const d=new Date,E=new Date(a),o=d.getTime()-E.getTime(),W=Math.floor(o/1e3),U=Math.floor(W/60),pe=Math.floor(U/60),ge=Math.floor(pe/24),Le=Math.floor(ge/7);return W<60?"just now":U<60?`${U}m`:pe<24?`${pe}h`:ge<7?`${ge}d`:Le<4?`${Le}w`:E.toLocaleDateString("en-US",{month:"short",day:"numeric"})}function ye(a){var d;return((d=a==null?void 0:a.charAt(0))==null?void 0:d.toUpperCase())||"?"}async function me(a){var d;try{const E=((d=e(ee))==null?void 0:d.id)||null,o=Me()||null,W=await Fe.toggleCommentLike(a,E,o);W.action==="liked"?e(k).add(a):e(k).delete(a),m(k,e(k)),z(z().map(U=>U.id===a?{...U,likes_count:W.likes_count}:U))}catch(E){console.error("Error toggling like:",E)}}async function Ie(){if(!(!e(X).trim()||!e(b).trim()||e(I))){m(I,!0);try{await He()(e(X),e(b),"",null),m(X,"")}finally{m(I,!1)}}}async function Ye(a){if(!(!e(K).trim()||!e(b).trim()||e(I))){m(I,!0);try{await He()(e(K),e(b),"",a),m(K,""),m(_e,null)}finally{m(I,!1)}}}function it(a,d){m(_e,a),m(K,`@${d} `),setTimeout(()=>{var E;(E=document.getElementById(`reply-${a}`))==null||E.focus()},50)}Q(()=>w(),()=>{m(ee,w().user)}),Q(()=>e(ee),()=>{var a;(a=e(ee))!=null&&a.email&&m(b,e(ee).email.split("@")[0])}),Q(()=>Re(z()),()=>{z().length>0&&st()}),Q(()=>Re(z()),()=>{m(A,z().filter(a=>!a.parent_id))}),Q(()=>Re(z()),()=>{m(L,z().reduce((a,d)=>(d.parent_id&&(a[d.parent_id]||(a[d.parent_id]=[]),a[d.parent_id].push(d)),a),{}))}),Q(()=>(Re(z()),e(A),e(L)),()=>{z().length>0&&(console.log("Total comments:",z().length),console.log("Top-level comments:",e(A).length),console.log("Comment replies structure:",e(L)),console.log("All comments:",z().map(a=>({id:a.id,parent_id:a.parent_id,content:a.content.substring(0,30)}))))}),Rt(),Lt();var Ue=yr(),i=r(Ue),y=r(i);{var O=a=>{var d=lr();c(a,d)},Ee=a=>{var d=hr();Ce(d,5,()=>e(A),Te,(E,o)=>{var W=_r(),U=r(W),pe=r(U),ge=r(pe),Le=r(ge,!0);t(ge),t(pe);var D=l(pe,2),_=r(D),P=r(_),V=r(P),q=r(V),re=r(q,!0);t(q);var te=l(q,2),se=r(te,!0);t(te),t(V);var B=l(V,2),Y=r(B),ae=r(Y,!0);t(Y);var ce=l(Y,2);{var oe=T=>{var j=dr(),fe=r(j);t(j),N(()=>h(fe,`${e(o),n(()=>e(o).likes_count)??""} ${e(o),n(()=>e(o).likes_count===1?"like":"likes")??""}`)),H("click",j,()=>me(e(o).id)),c(T,j)};S(ce,T=>{e(o),n(()=>(e(o).likes_count||0)>0)&&T(oe)})}var g=l(ce,2),$=r(g,!0);t(g);var R=l(g,2),Z=l(R,2);{var J=T=>{var j=cr();H("click",j,()=>G()(e(o).id)),c(T,j)};S(Z,T=>{Re(s()),e(o),n(()=>s()(e(o)))&&T(J)})}t(B),t(P);var ie=l(P,2),Vt=r(ie);{let T=wt(()=>(e(k),e(o),n(()=>e(k).has(e(o).id)?"fill-red-500 text-red-500":"text-gray-400")));It(Vt,{get class(){return`w-3 h-3 sm:w-3.5 sm:h-3.5 ${e(T)??""}`}})}t(ie),t(_);var _t=l(_,2);{var Bt=T=>{var j=gr(),fe=r(j);Ce(fe,1,()=>(e(o),n(()=>at(e(o).id))),Te,(ne,v)=>{var ke=ur(),F=r(ke),be=r(F),Xe=r(be,!0);t(be),t(F);var qe=l(F,2),Ze=r(qe),dt=r(Ze),ct=r(dt),mt=r(ct),Ot=r(mt,!0);t(mt);var ht=l(mt,2),Yt=r(ht,!0);t(ht),t(ct);var bt=l(ct,2),vt=r(bt),Gt=r(vt,!0);t(vt);var yt=l(vt,2);{var Kt=le=>{var xe=mr(),pt=r(xe);t(xe),N(()=>h(pt,`${e(v),n(()=>e(v).likes_count)??""} ${e(v),n(()=>e(v).likes_count===1?"like":"likes")??""}`)),H("click",xe,()=>me(e(v).id)),c(le,xe)};S(yt,le=>{e(v),n(()=>(e(v).likes_count||0)>0)&&le(Kt)})}var Je=l(yt,2),Wt=r(Je,!0);t(Je);var Xt=l(Je,2);{var Zt=le=>{var xe=vr();H("click",xe,()=>G()(e(v).id)),c(le,xe)};S(Xt,le=>{Re(s()),e(v),n(()=>s()(e(v)))&&le(Zt)})}t(bt),t(dt);var ut=l(dt,2),Jt=r(ut);{let le=wt(()=>(e(k),e(v),n(()=>e(k).has(e(v).id)?"fill-red-500 text-red-500":"text-gray-400")));It(Jt,{get class(){return`w-2.5 h-2.5 sm:w-3 sm:h-3 ${e(le)??""}`}})}t(ut),t(Ze),t(qe),t(ke),N((le,xe,pt)=>{h(Xe,le),h(Ot,(e(v),n(()=>e(v).author_name||"Anonymous"))),h(Yt,(e(v),n(()=>e(v).content))),h(Gt,xe),h(Wt,pt)},[()=>(e(v),n(()=>ye(e(v).author_name||"Anonymous"))),()=>(e(v),n(()=>Ne(e(v).created_at))),()=>(e(k),e(v),n(()=>e(k).has(e(v).id)?"Unlike":"Like"))]),H("click",Je,()=>me(e(v).id)),H("click",ut,()=>me(e(v).id)),c(ne,ke)});var lt=l(fe,2);{var We=ne=>{var v=pr(),ke=l(r(v));t(v),N((F,be)=>h(ke,` View ${F??""} more ${be??""}`),[()=>(e(o),n(()=>Pe(e(o).id))),()=>(e(o),n(()=>Pe(e(o).id)===1?"reply":"replies"))]),H("click",v,()=>ot(e(o).id)),c(ne,v)};S(lt,ne=>{e(de),e(o),n(()=>!e(de)[e(o).id]&&Pe(e(o).id)>0)&&ne(We)})}t(j),c(T,j)};S(_t,T=>{e(L),e(o),n(()=>e(L)[e(o).id]&&e(L)[e(o).id].length>0)&&T(Bt)})}var Ft=l(_t,2);{var Ht=T=>{var j=xr(),fe=r(j);{var lt=F=>{var be=fr(),Xe=r(be),qe=l(Xe,2);Qe(qe),t(be),N(()=>{Se(Xe,"for",`reply-author-name-${e(o),n(()=>e(o).id)??""}`),Se(qe,"id",`reply-author-name-${e(o),n(()=>e(o).id)??""}`)}),tt(qe,()=>e(b),Ze=>m(b,Ze)),c(F,be)};S(fe,F=>{e(ee)||F(lt)})}var We=l(fe,2),ne=r(We);Qe(ne);var v=l(ne,2),ke=l(v,2);t(We),t(j),N(F=>{Se(ne,"id",`reply-${e(o),n(()=>e(o).id)??""}`),v.disabled=F},[()=>(e(K),e(b),e(I),n(()=>!e(K).trim()||!e(b).trim()||e(I)))]),tt(ne,()=>e(K),F=>m(K,F)),H("keydown",ne,F=>F.key==="Enter"&&!F.shiftKey&&Ye(e(o).id)),H("click",v,()=>Ye(e(o).id)),H("click",ke,()=>{m(_e,null),m(K,"")}),c(T,j)};S(Ft,T=>{e(_e),e(o),n(()=>e(_e)===e(o).id)&&T(Ht)})}t(D),t(U),t(W),N((T,j,fe)=>{h(Le,T),h(re,(e(o),n(()=>e(o).author_name||"Anonymous"))),h(se,(e(o),n(()=>e(o).content))),h(ae,j),h($,fe)},[()=>(e(o),n(()=>ye(e(o).author_name||"Anonymous"))),()=>(e(o),n(()=>Ne(e(o).created_at))),()=>(e(k),e(o),n(()=>e(k).has(e(o).id)?"Unlike":"Like"))]),H("click",g,()=>me(e(o).id)),H("click",R,()=>it(e(o).id,e(o).author_name||"Anonymous")),H("click",ie,()=>me(e(o).id)),c(E,W)}),t(d),c(a,d)};S(y,a=>{e(A),n(()=>e(A).length===0)?a(O):a(Ee,!1)})}t(i);var ve=l(i,2),ue=r(ve);{var De=a=>{var d=br(),E=l(r(d),2);Qe(E),t(d),tt(E,()=>e(b),o=>m(b,o)),c(a,d)};S(ue,a=>{e(ee)||a(De)})}var je=l(ue,2),ze=r(je),Ge=r(ze),Ke=r(Ge,!0);t(Ge),t(ze);var we=l(ze,2),he=r(we);Qe(he);var Ae=l(he,2),nt=r(Ae);nr(nt,{class:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),t(Ae),t(we),t(je),t(ve),t(Ue),N((a,d)=>{h(Ke,a),he.disabled=e(I),Ae.disabled=d},[()=>(e(b),n(()=>ye(e(b)||"You"))),()=>(e(X),e(b),e(I),n(()=>!e(X).trim()||!e(b).trim()||e(I)))]),tt(he,()=>e(X),a=>m(X,a)),H("keydown",he,a=>a.key==="Enter"&&!a.shiftKey&&Ie()),H("click",Ae,Ie),c(f,Ue),Tt(),M()}var kr=u('<div class="flex items-center justify-center py-20 sm:py-32"><div class="animate-spin rounded-full h-12 w-12 sm:h-16 sm:w-16 border-b-3 border-primary"></div></div>'),$r=u('<img class="absolute inset-0 w-full h-full object-contain opacity-90"/>'),Cr=u("<button></button>"),Sr=u('<div class="absolute bottom-8 sm:bottom-12 left-1/2 -translate-x-1/2 flex gap-2 sm:gap-3 z-20"></div>'),Ir=u('<div class="relative w-full h-[50vh] sm:h-[60vh] md:h-[70vh] lg:h-[75vh] overflow-hidden bg-gradient-to-b from-gray-900 to-black"><!> <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent"></div> <div class="absolute top-4 left-4 sm:top-6 sm:left-6 md:top-8 md:left-8 z-20"><a href="/" class="inline-flex items-center gap-2 px-4 py-2 bg-white/10 backdrop-blur-md text-white hover:bg-white/20 rounded-full font-semibold transition-all shadow-lg border border-white/20"><!> <span class="hidden sm:inline">Back to home</span></a></div> <!></div>'),Er=u('<div class="bg-gradient-to-r from-primary/5 to-gold-dark/5 py-8 sm:py-12 md:py-16"><div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-6xl"><a href="/" class="inline-flex items-center gap-2 text-primary hover:text-gold-dark mb-6 font-semibold transition-colors"><!> Back to home</a></div></div>'),Dr=u('<span class="px-3 py-1.5 bg-gradient-to-r from-primary to-gold-dark text-white rounded-full text-xs sm:text-sm font-bold shadow-sm uppercase tracking-wide"> </span>'),Ar=u('<div class="flex flex-wrap gap-2 mb-4 sm:mb-5"></div>'),Lr=u('<div class="flex items-center gap-2"><!> <span class="font-medium"> </span></div>'),qr=u('<div class="bg-white rounded-2xl sm:rounded-3xl shadow-2xl p-6 sm:p-8 md:p-10 lg:p-12"><!> <h1 class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-extrabold text-black mb-5 sm:mb-6 md:mb-8 leading-[1.1] tracking-tight"> </h1> <div class="flex flex-wrap items-center gap-4 sm:gap-6 text-sm sm:text-base text-gray-600 border-t border-gray-200 pt-5 sm:pt-6"><div class="flex items-center gap-2"><!> <span class="font-medium"> </span></div> <!></div></div>'),Rr=u('<span class="px-3 py-1.5 bg-gradient-to-r from-primary to-gold-dark text-white rounded-full text-xs sm:text-sm font-bold shadow-sm uppercase tracking-wide"> </span>'),Tr=u('<div class="flex flex-wrap gap-2 mb-4 sm:mb-5"></div>'),Mr=u('<div class="flex items-center gap-2"><!> <span class="font-medium"> </span></div>'),Pr=u('<div class="bg-white rounded-2xl shadow-lg p-6 sm:p-8 md:p-10"><!> <h1 class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-extrabold text-black mb-5 sm:mb-6 leading-[1.1] tracking-tight"> </h1> <div class="flex flex-wrap items-center gap-4 sm:gap-6 text-sm sm:text-base text-gray-600 border-t border-gray-200 pt-5"><div class="flex items-center gap-2"><!> <span class="font-medium"> </span></div> <!></div></div>'),Nr=u('<span class="px-4 py-2 bg-gradient-to-r from-gray-50 to-gray-100 text-gray-800 rounded-lg text-sm sm:text-base font-semibold border border-gray-200 hover:border-primary hover:shadow-md transition-all cursor-pointer"> </span>'),Ur=u('<div class="bg-white rounded-xl sm:rounded-2xl shadow-lg p-6 sm:p-8 mb-8 sm:mb-10 md:mb-12"><h3 class="text-lg sm:text-xl font-bold mb-4 text-black flex items-center gap-2"><span class="w-1 h-6 bg-gradient-to-b from-primary to-gold-dark rounded-full"></span> Topics</h3> <div class="flex flex-wrap gap-2 sm:gap-3"></div></div>'),jr=u(`<!> <article class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-6xl"><header><div class="max-w-4xl mx-auto"><!></div></header> <div class="max-w-4xl mx-auto"><div class="bg-white rounded-xl sm:rounded-2xl shadow-lg p-6 sm:p-8 md:p-10 lg:p-12 mb-8 sm:mb-10 md:mb-12"><div class="prose prose-base sm:prose-lg lg:prose-xl max-w-none
						prose-headings:text-black prose-headings:font-bold prose-headings:tracking-tight
						prose-h1:text-3xl prose-h1:sm:text-4xl prose-h1:mb-6
						prose-h2:text-2xl prose-h2:sm:text-3xl prose-h2:mt-10 prose-h2:mb-5
						prose-h3:text-xl prose-h3:sm:text-2xl prose-h3:mt-8 prose-h3:mb-4
						prose-p:text-gray-700 prose-p:leading-relaxed prose-p:mb-6
						prose-a:text-primary prose-a:font-semibold prose-a:no-underline hover:prose-a:underline
						prose-strong:text-black prose-strong:font-bold
						prose-em:text-gray-800
						prose-blockquote:border-l-4 prose-blockquote:border-primary prose-blockquote:bg-gray-50 prose-blockquote:py-4 prose-blockquote:px-6 prose-blockquote:rounded-r-lg
						prose-code:text-primary prose-code:bg-gray-100 prose-code:px-2 prose-code:py-1 prose-code:rounded
						prose-pre:bg-gray-900 prose-pre:text-gray-100
						prose-img:rounded-xl prose-img:shadow-xl prose-img:my-8
						prose-ul:my-6 prose-ol:my-6
						prose-li:my-2"><!></div></div> <!> <div class="bg-white rounded-xl sm:rounded-2xl shadow-lg p-6 sm:p-8 md:p-10"><h2 class="text-2xl sm:text-3xl font-bold mb-6 sm:mb-8 text-black flex items-center gap-3"><span class="w-1.5 h-8 bg-gradient-to-b from-primary to-gold-dark rounded-full"></span> Comments</h2> <!></div></div></article> <div class="h-12 sm:h-16 md:h-20"></div>`,1),zr=u('<div class="container mx-auto px-4 sm:px-6 py-12 sm:py-16 text-center"><h1 class="text-2xl sm:text-3xl font-bold mb-4 text-black">Post not found</h1> <a href="/" class="text-primary hover:text-gold-dark font-semibold transition-colors">Return to home</a></div>'),Vr=u('<div class="min-h-screen bg-gradient-to-b from-gray-50 to-white"><!></div>');function ds(f,p){qt(p,!1);const w=()=>ft(or,"$page",M),x=()=>ft(xt,"$authStore",M),[M,ee]=Nt(),A=C(),L=C(),z=C(),He=C(),G=C();let s=C(null),Me=C(!0),X=C([]),_e=!1,K=C(""),k=null,I=C(0),b=C(null);const de=5e3;function Oe(){let i=localStorage.getItem("commentSessionId");return i||(i="session_"+Date.now()+"_"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),localStorage.setItem("commentSessionId",i)),i}function st(i){return!!(e(L)&&i.user_id===e(L).id||i.session_id&&i.session_id===e(K))}async function at(i,y,O,Ee){console.log("handleSubmitComment called with parentId:",Ee);try{const ve={post_id:e(A),author_name:y,author_email:O||void 0,content:i,session_id:e(L)?void 0:e(K),parent_id:Ee||null};console.log("Comment data being sent:",ve),await Fe.createComment(ve),await ye(),et.success("Comment posted successfully!")}catch(ve){console.error("Error posting comment:",ve),et.error("Failed to post comment. Please try again.")}}async function Pe(i){if(confirm("Are you sure you want to delete this comment?"))try{await Fe.deleteComment(i),await ye(),et.success("Comment deleted successfully")}catch(y){console.error("Error deleting comment:",y),et.error("Failed to delete comment")}}function ot(){let i=localStorage.getItem("anonId");return i?console.log("Retrieved existing anonymous ID:",i):(i="anon_"+Date.now()+"_"+Math.random().toString(36).substring(2,15),localStorage.setItem("anonId",i),console.log("Generated new anonymous ID:",i)),i}Qt(()=>((async()=>{try{if(m(s,await St.getPostById(e(A))),e(z)){console.log("Waiting for auth to load...");const y=xt.subscribe(O=>{O.loading||(y(),Ne())})}else Ne();await ye(),ir&&m(K,Oe())}catch(y){console.error("Error loading post:",y)}finally{m(Me,!1)}})(),()=>{k&&(clearTimeout(k),console.log("View count cancelled - user left before 5 seconds"),k=null)}));function Ne(){const i=x().user;if(console.log("=== Auth loaded. Current user state:",i?`Logged in as ${i.email}`:"Anonymous visitor"),i)i&&(console.log("✗ Logged-in user detected - view will NOT be counted"),console.log("  User email:",i.email));else{const y=ot();console.log("✓ Anonymous visitor detected. Starting 5-second timer before counting view..."),console.log("  Anonymous ID:",y),console.log("  Post ID:",e(A)),k=setTimeout(()=>{console.log("✓ 5 seconds elapsed. Counting view now..."),St.incrementViews(e(A),y).then(O=>{O&&e(s)?(console.log("✓ View counted successfully! Count:",e(s).views,"→",O.views),Mt(s,e(s).views=O.views)):console.log("⚠ View already counted for this device (duplicate prevented)")}).catch(O=>{console.error("✗ Error counting view:",O)}),k=null},5e3)}}async function ye(){try{_e=!0,m(X,await Fe.getPostComments(e(A))),console.log("Loaded comments:",e(X).length,e(X))}catch(i){console.error("Error loading comments:",i),m(X,[])}finally{_e=!1}}function me(i){return i?i>=1e3?(i/1e3).toFixed(1)+"k":i.toString():"0"}er(()=>{k&&clearTimeout(k),e(b)&&(clearInterval(e(b)),m(b,null))}),Q(()=>w(),()=>{m(A,w().params.id)}),Q(()=>x(),()=>{m(L,x().user)}),Q(()=>x(),()=>{m(z,x().loading)}),Q(()=>e(L),()=>{var i;m(He,((i=e(L))==null?void 0:i.email)||null)}),Q(()=>(e(s),e(b),e(I)),()=>{var i;(i=e(s))!=null&&i.cover_images&&e(s).cover_images.length>1&&!e(b)&&m(b,setInterval(()=>{m(I,(e(I)+1)%e(s).cover_images.length)},de))}),Q(()=>(e(s),e(I)),()=>{var i;if(typeof window<"u"&&((i=e(s))!=null&&i.cover_images)&&e(s).cover_images.length>1){const y=(e(I)+1)%e(s).cover_images.length,O=new Image;O.src=e(s).cover_images[y]}}),Q(()=>e(s),()=>{var i,y;m(G,(i=e(s))!=null&&i.cover_images&&e(s).cover_images.length>0?e(s).cover_images:(y=e(s))!=null&&y.cover_image?[e(s).cover_image]:[])}),Rt(),Lt();var Ie=Vr();sr("1sv6dbf",i=>{tr(()=>{rr.title=`${e(s),n(()=>e(s)?e(s).title:"Loading...")??""} - ChristFocus`})});var Ye=r(Ie);{var it=i=>{var y=kr();c(i,y)},Ue=i=>{var y=rt(),O=Be(y);{var Ee=ue=>{var De=jr(),je=Be(De);{var ze=D=>{var _=Ir(),P=r(_);Ce(P,3,()=>e(G),B=>B,(B,Y,ae)=>{var ce=rt(),oe=Be(ce);{var g=$=>{var R=$r();N(()=>{Se(R,"src",e(Y)),Se(R,"alt",`${e(s),n(()=>e(s).title)??""} - Image ${e(ae)+1}`),Se(R,"loading",e(ae)===0?"eager":"lazy")}),$t(1,R,()=>Ct,()=>({duration:1e3})),$t(2,R,()=>Ct,()=>({duration:1e3})),c($,R)};S(oe,$=>{e(ae)===e(I)&&$(g)})}c(B,ce)});var V=l(P,4),q=r(V),re=r(q);At(re,{class:"w-4 h-4 sm:w-5 sm:h-5"}),gt(2),t(q),t(V);var te=l(V,2);{var se=B=>{var Y=Sr();Ce(Y,5,()=>e(G),Te,(ae,ce,oe)=>{var g=Cr();Se(g,"aria-label",`Go to image ${oe+1}`),N(()=>kt(g,1,`w-2 h-2 sm:w-2.5 sm:h-2.5 rounded-full transition-all duration-300 ${oe===e(I)?"bg-primary w-6 sm:w-8":"bg-white/50 hover:bg-white/70"}`)),H("click",g,()=>m(I,oe)),c(ae,g)}),t(Y),c(B,Y)};S(te,B=>{e(G),n(()=>e(G).length>1)&&B(se)})}t(_),c(D,_)},Ge=D=>{var _=Er(),P=r(_),V=r(P),q=r(V);At(q,{class:"w-4 h-4 sm:w-5 sm:h-5"}),gt(),t(V),t(P),t(_),c(D,_)};S(je,D=>{e(G),n(()=>e(G).length>0)?D(ze):D(Ge,!1)})}var Ke=l(je,2),we=r(Ke),he=r(we),Ae=r(he);{var nt=D=>{var _=qr(),P=r(_);{var V=g=>{var $=Ar();Ce($,5,()=>(e(s),n(()=>e(s).categories)),Te,(R,Z)=>{var J=Dr(),ie=r(J,!0);t(J),N(()=>h(ie,(e(Z),n(()=>e(Z).name)))),c(R,J)}),t($),c(g,$)};S(P,g=>{e(s),n(()=>e(s).categories&&e(s).categories.length>0)&&g(V)})}var q=l(P,2),re=r(q,!0);t(q);var te=l(q,2),se=r(te),B=r(se);Et(B,{class:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0 text-primary"});var Y=l(B,2),ae=r(Y,!0);t(Y),t(se);var ce=l(se,2);{var oe=g=>{var $=Lr(),R=r($);Dt(R,{class:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0 text-primary"});var Z=l(R,2),J=r(Z);t(Z),t($),N(ie=>h(J,`${ie??""} views`),[()=>(e(s),n(()=>me(e(s).views)))]),c(g,$)};S(ce,g=>{e(s),n(()=>typeof e(s).views<"u")&&g(oe)})}t(te),t(_),N(g=>{h(re,(e(s),n(()=>e(s).title))),h(ae,g)},[()=>(e(s),n(()=>new Date(e(s).created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})))]),c(D,_)},a=D=>{var _=Pr(),P=r(_);{var V=g=>{var $=Tr();Ce($,5,()=>(e(s),n(()=>e(s).categories)),Te,(R,Z)=>{var J=Rr(),ie=r(J,!0);t(J),N(()=>h(ie,(e(Z),n(()=>e(Z).name)))),c(R,J)}),t($),c(g,$)};S(P,g=>{e(s),n(()=>e(s).categories&&e(s).categories.length>0)&&g(V)})}var q=l(P,2),re=r(q,!0);t(q);var te=l(q,2),se=r(te),B=r(se);Et(B,{class:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0 text-primary"});var Y=l(B,2),ae=r(Y,!0);t(Y),t(se);var ce=l(se,2);{var oe=g=>{var $=Mr(),R=r($);Dt(R,{class:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0 text-primary"});var Z=l(R,2),J=r(Z);t(Z),t($),N(ie=>h(J,`${ie??""} views`),[()=>(e(s),n(()=>me(e(s).views)))]),c(g,$)};S(ce,g=>{e(s),n(()=>typeof e(s).views<"u")&&g(oe)})}t(te),t(_),N(g=>{h(re,(e(s),n(()=>e(s).title))),h(ae,g)},[()=>(e(s),n(()=>new Date(e(s).created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})))]),c(D,_)};S(Ae,D=>{e(G),n(()=>e(G).length>0)?D(nt):D(a,!1)})}t(he),t(we);var d=l(we,2),E=r(d),o=r(E),W=r(o);ar(W,()=>(e(s),n(()=>e(s).content))),t(o),t(E);var U=l(E,2);{var pe=D=>{var _=Ur(),P=l(r(_),2);Ce(P,5,()=>(e(s),n(()=>e(s).tags)),Te,(V,q)=>{var re=Nr(),te=r(re,!0);t(re),N(()=>h(te,(e(q),n(()=>e(q).name)))),c(V,re)}),t(P),t(_),c(D,_)};S(U,D=>{e(s),n(()=>e(s).tags&&e(s).tags.length>0)&&D(pe)})}var ge=l(U,2),Le=l(r(ge),2);wr(Le,{get comments(){return e(X)},onSubmitComment:at,onDeleteComment:Pe,canDelete:st,get commentSessionId(){return e(K)}}),t(ge),t(d),t(Ke),gt(2),N(()=>kt(we,1,`-mt-20 sm:-mt-24 md:-mt-32 lg:-mt-40 relative z-10 ${e(G),n(()=>e(G).length>0?"mb-8 sm:mb-12 md:mb-16":"mb-6 sm:mb-8 md:mb-10")??""}`)),c(ue,De)},ve=ue=>{var De=zr();c(ue,De)};S(O,ue=>{e(s)?ue(Ee):ue(ve,!1)},!0)}c(i,y)};S(Ye,i=>{e(Me)?i(it):i(Ue,!1)})}t(Ie),c(f,Ie),Tt(),ee()}export{ds as component};
