var F=Object.defineProperty;var M=t=>{throw TypeError(t)};var U=(t,e,s)=>e in t?F(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var D=(t,e,s)=>U(t,typeof e!="symbol"?e+"":e,s),N=(t,e,s)=>e.has(t)||M("Cannot "+s);var a=(t,e,s)=>(N(t,e,"read from private field"),s?s.call(t):e.get(t)),d=(t,e,s)=>e.has(t)?M("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),S=(t,e,s,i)=>(N(t,e,"write to private field"),i?i.call(t,s):e.set(t,s),s);import{K as x,ab as j,ac as y,ad as C,ae as A,af as B,h as E,y as I,ag as K,ah as O,N as T,ai as k,m as $,aj as q,s as z,ak as G,g as H,al as J}from"./DfM-zcOs.js";var c,u,f,l,p,_,m;class Q{constructor(e,s=!0){D(this,"anchor");d(this,c,new Map);d(this,u,new Map);d(this,f,new Map);d(this,l,new Set);d(this,p,!0);d(this,_,()=>{var e=x;if(a(this,c).has(e)){var s=a(this,c).get(e),i=a(this,u).get(s);if(i)j(i),a(this,l).delete(s);else{var n=a(this,f).get(s);n&&(a(this,u).set(s,n.effect),a(this,f).delete(s),n.fragment.lastChild.remove(),this.anchor.before(n.fragment),i=n.effect)}for(const[r,o]of a(this,c)){if(a(this,c).delete(r),r===e)break;const h=a(this,f).get(o);h&&(y(h.effect),a(this,f).delete(o))}for(const[r,o]of a(this,u)){if(r===s||a(this,l).has(r))continue;const h=()=>{if(Array.from(a(this,c).values()).includes(r)){var g=document.createDocumentFragment();K(o,g),g.append(A()),a(this,f).set(r,{effect:o,fragment:g})}else y(o);a(this,l).delete(r),a(this,u).delete(r)};a(this,p)||!i?(a(this,l).add(r),C(o,h,!1)):h()}}});d(this,m,e=>{a(this,c).delete(e);const s=Array.from(a(this,c).values());for(const[i,n]of a(this,f))s.includes(i)||(y(n.effect),a(this,f).delete(i))});this.anchor=e,S(this,p,s)}ensure(e,s){var i=x,n=O();if(s&&!a(this,u).has(e)&&!a(this,f).has(e))if(n){var r=document.createDocumentFragment(),o=A();r.append(o),a(this,f).set(e,{effect:B(()=>s(o)),fragment:r})}else a(this,u).set(e,B(()=>s(this.anchor)));if(a(this,c).set(i,e),n){for(const[h,b]of a(this,u))h===e?i.skipped_effects.delete(b):i.skipped_effects.add(b);for(const[h,b]of a(this,f))h===e?i.skipped_effects.delete(b.effect):i.skipped_effects.add(b.effect);i.oncommit(a(this,_)),i.ondiscard(a(this,m))}else E&&(this.anchor=I),a(this,_).call(this)}}c=new WeakMap,u=new WeakMap,f=new WeakMap,l=new WeakMap,p=new WeakMap,_=new WeakMap,m=new WeakMap;let v=!1,w=Symbol();function R(t,e,s){const i=s[e]??(s[e]={store:null,source:$(void 0),unsubscribe:k});if(i.store!==t&&!(w in s))if(i.unsubscribe(),i.store=t??null,t==null)i.source.v=void 0,i.unsubscribe=k;else{var n=!0;i.unsubscribe=q(t,r=>{n?i.source.v=r:z(i.source,r)}),n=!1}return t&&w in s?G(t):H(i.source)}function V(t,e,s){let i=s[e];return i&&i.store!==t&&(i.unsubscribe(),i.unsubscribe=k),t}function W(){const t={};function e(){T(()=>{for(var s in t)t[s].unsubscribe();J(t,w,{enumerable:!1,value:!0})})}return[t,e]}function X(t){var e=v;try{return v=!1,[t(),v]}finally{v=e}}export{Q as B,R as a,V as b,X as c,W as s};
